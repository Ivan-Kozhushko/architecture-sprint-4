# Планирование: анализ, идентификация проблем и поиск решений

## Проанализируйте схему и описание системы

1. Судя по описанию проблем компании, есть много случаев, когда над заказом клиентов работают несколько месяцев, и заказ все еще не завершен. Из описания ясно, что проблем на
стороне производства нет. Значит можно сделать вывод, что заказ "теряется" где-то в цепочке. Для выявления узких мест в данной проблеме необходимо ввести трейсинг для возможности поиска, на каком из этапов заказ был "утерян";
2. Еще одной из проблем недовольства клиентов может быть недостаточное количество статусов у заказа. Клиенту недостаточно информации, что его заказ "в работе" на протяжении месяца, необходимо внедрить более прозрачную систему статусов заказа;
3. По многочисленным жалобам от операторов понятно, что первая страница MES прогружается непростительно долго. Для ускорения прогрузки страницы, и, тем самым, ускорению приема заказов в работу, необходимо внедрить в систему кеширование. Первичный анализ показал, что кеширования требует именно первая страница MES, более детальное углубление в данном вопросе может показать, что кеширование потребует и в других местах. Паттерн кеширования необходимо выбрать только после более детального анализа системы. Так же на замедление работы в данной части могут влиять "тяжелые" запросы к БД;
4. Ручное тесторование силами QA-инженера E2E-сценариев, и дальнейшие действия при обнаружении ошибок, а так же ручной деплой в release и prod среды сильно замедляет процесс выноса доработок. CI/CD не внедрен в том виде, в котором должен был. Необходимо автоматизировать CI, как раз QA-инженер уже двигался в этом направлении, так же необходимо автоматизировать CD, для этого воспользуемся силами DevOps-инженера;
5. Медленный расчет стоимости в MES при обработке сложных 3D моделей;
6. CRM и MES взаимодействуют через RabbitMQ. Из-за большой нагрузки могут случиться задержки в обратоке сообщений, что приведет к тому, что заказы будут копиться;
7. Большая нагрузка на API для внешних продавцов, которая может привести к сбоям и задержкам;
8. Использование одной БД для магазина и CRM. Это может привести к проблемам на запись и неконсистентности в чтении;
9. Бекенд на MES используется для 3rd party пользователей, это приведет к:
    - сложностям из-за разных контрактов для внутреннего пользователя и внешнего — возможны проблемы с безопасностью;
    - необходимости поддерживать старые версии контракта для внешних пользователей — от этого будет сложно уйти.
10. Недостаточное количество разработчиков для доработок по MES.

## Разработайте инициативы, которые необходимы для устранения нежелательных ситуаций

1. Внедрения трейсинга и мониторинга для отслеживания жизненного цикла заказа;
2. Внедрение более прозрачных статусов заказа, внедрение уведомлений о заказах через CRM;
3. Оптимизация запросов в MES. Анализ БД и запросов к ним, оптимизация запросов, оптимизация структуры БД, добавление индексов/партицирования при необходимости;
4. Налаживание процесса CI/CD.
5. Ускорение расчета стоимости по 3D моделям в MES. Возможно внедрения параллельной обработки полигонов.
6. Анализ интеграции CRM и MES и дальнейшей ее оптимизации, улучшение очереди сообщений RabbitMQ;
7. Внедрение кеширования и мастабирование серверной части для API внешних продавцов.

## Расставьте инициативы в порядке приоритета

Высокий:

1. Оптимизация очереди сообщений RabbitMQ:
    - основной процесс, из-за которого происодят задержки заказа.
2. Улучшение API внешних продавцов:
    - необходимо, чтоб не потерять клиентов B2B, которые приносят наибольшую прибыль.

Средний:

1. Внедрение новых статусов и уведомлений для клиентов:
    - для улучшения опыта пользователя.
2. Оптимизация запросов в MES + кеширование:
    - для ускорения работы операторов.
3. Налаживание процессов CI/CD:
    - для ускорения выноса доработок и минимизации столкновения с ошибками после их выноса.

Низкий:

1. Ускорение расчета стоимости по 3D моделям.
    - проблема только на сложных моделях, и доработка будет достаточно трудозатратной из-за крупных изменениях в MES.
2. Трейсинг + мониторинг:
    - доработка на долгосрочную перспективу, ытоб избежать проблем в будущем.

### Целевая архитектура через полгода

Через полгода архитектура должна стать более надедной и мастабируемой. Необходимо улучшить пользовательскую поддержку, а так же оптимизировать интеграции. Также необходимо внедрить мониторинг для оценки роста производительности системы после реализации всех доработок.

### Выбор из трех инициатив

1. Оптимизация очереди сообщений RabbitMQ, т.к. основная потеря заказов сейчас кроется тут;
2. Улучшение API для внешних продавцов для удержания текущих B2B клиентов и привлечения новых;
3. Налаживание процессов CI/CD для более качественного и ускоренного выноса каких-либо доработок.