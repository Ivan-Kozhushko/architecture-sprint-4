# Архитектурное решение по трейсингу

## Мотивация

Решение внедрить трейсинг поможет компании детальное понимание о том, в каком месте, и по какой причине заказы могут "ломаться" или задерживаться на всех этапах обработки. Внедрение данного решения критически необходимо для быстрого обнаружения и устранения проблем. В первую очередь, это поможет находить ошибки и проблемы в приложении первее клиентов, что повысит эффективность работы и удовлетворенность клиентов.

Технические и бизнес-метрики, на которые влияет трейсинг:

1. Время обработки заказа: Сокращение задержек и оптимизация процесса;
2. Частота ошибок в обработке: Быстрое обнаружение и устранение ошибок;
3. Удовлетворенность клиентов: Уменьшение количества жалоб благодаря более точной и быстрой обработке заказов.

## Предлагаемое решение

Системы для покрытия трейсингом:

- Shop API
- CRM API
- MES API
- RabbitMQ интеграция
- 3D-файловое хранилище

Данные для трейсинга:

- время начала и завершения обработки каждого заказа;
- детали API-запросов и ответов (включая ошибки);
- информация о маршрутах сообщений в RabbitMQ;
- время загрузки и обработки 3D-моделей;
- идентификаторы заказов и их статусы.

Технологии для реализации:

- OpenTelemetry для сбора и агрегации трейсинг-данных;
- Jaeger для визуализации и анализа трейсинга.

Компоненты для внедрения:

- агенты трейсинга в каждом ключевом сервисе (Shop API, CRM API, MES API);
- интеграция с RabbitMQ для отслеживания сообщений;
- хранилище трейсинг-данных.

### [Ссылка на обновленную диаграмму C4](task3.drawio)

## Компромиссы

Трейсинг может быть неэффективен в системах, где:

- сложно заставить проприетарную систему отдавать метрики в нужном формате;
- высокий объем данных создает значительную нагрузку и требует дорогих ресурсов для хранения и обработки;
- внедрение трейсинга приведет к значительным изменениям в архитектуре, что может быть дорого и времязатратно.

## Аспекты безопасности

- аутентификация и авторизация: Доступ к системе трейсинга только для сотрудников с ролью «Поддержка»;
- шифрование данных: Использование TLS/SSL для передачи трейсинг-данных.